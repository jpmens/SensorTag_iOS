Code taken from https://git.ti.com
All licenses as per TI and the code herein. Copied because the git.ti.com site 
is horrendously broken.
